% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/write_formatted_excel.R
\name{write_formatted_excel}
\alias{write_formatted_excel}
\title{Write Formatted Excel Workbook With Testable Style Logging}
\usage{
write_formatted_excel(
  write_list,
  output_path,
  cols_for_color = NULL,
  header_front_size = 12,
  header_front_color = "#FFFFFF",
  header_fill_color = "darkblue",
  header_front = "Aptos",
  body_front = "Aptos",
  body_front_size = 11
)
}
\arguments{
\item{write_list}{A named list of data frames.
Each list element becomes one sheet in the Excel file, and its name is used
as the sheet name.}

\item{output_path}{File path where the Excel workbook will be saved.}

\item{cols_for_color}{Optional. A single column name in the data frame whose
unique values will be used to apply row-level color styling.
If \code{NULL} (default), no group coloring is applied.}

\item{header_front_size}{Numeric. Font size for the header row. Default: \code{12}.}

\item{header_front_color}{Character. Text color for the header row. Default: \code{"#FFFFFF"}.}

\item{header_fill_color}{Character. Background fill color for the header row.
Default: \code{"darkblue"}.}

\item{header_front}{Character. Font family for the header row. Default: \code{"Aptos"}.}

\item{body_front}{Character. Font family for all body rows. Default: \code{"Aptos"}.}

\item{body_front_size}{Numeric. Font size for body text. Default: \code{11}.}
}
\value{
A list of two elements:
\describe{
\item{\code{wb}}{The generated \code{openxlsx} workbook object.}
\item{\code{style_log}}{A tibble logging every style applied, suitable for \code{testthat} verification.}
}
}
\description{
\code{write_formatted_excel()} writes one or more data frames to an Excel file
with customizable header styling, body styling, and optional row coloring
based on a grouping variable.
}
\details{
In addition to producing a formatted Excel workbook, the function also
returns a \emph{testable style log} that records every styling action applied:
\itemize{
\item which sheet was styled
\item the type of style (\code{"header"}, \code{"body"}, or \code{"group"})
\item the grouping value (for group coloring)
\item the exact rows and columns affected
}

This makes the function fully unit-testable using \code{testthat}, without
depending on the internal XML/styling mechanics of the Excel file or the
version of \code{{openxlsx}}.

The function applies three categories of styling:

\strong{1. Header Styling}
A bold, centered header row with customizable background and font options.

\strong{2. Body Styling}
Standard body row styling applied to all non-header rows.

\strong{3. Group Row Coloring (Optional)}
If \code{cols_for_color} is provided, rows sharing the same value in that column
receive a unique background color (generated using \code{randomcoloR::randomColor()}).

All style operations are logged in a tibble called \code{style_log}, containing:

\itemize{
\item \code{sheet} — Sheet name
\item \code{style_type} — \code{"header"}, \code{"body"}, or \code{"group"}
\item \code{group_value} — Group identifier for \code{"group"} styles
\item \code{rows} — List column containing styled row indices
\item \code{cols} — List column containing styled column indices
}

This log allows unit tests to verify styling logic without reading Excel style XML.
}
\examples{
\dontrun{

# Example data
df <- data.frame(
  group = c("A", "B", "A"),
  value = c(5, 10, 15)
)

# Write styled workbook
out <- write_formatted_excel(
  write_list = list(sheet1 = df),
  output_path = "styled.xlsx",
  cols_for_color = "group"
)

# Examine style log
out$style_log

# Example testthat usage:
# expect_equal(out$style_log$style_type[1], "header")
}

}
\seealso{
\code{\link[openxlsx]{addStyle}}, \code{\link[randomcoloR]{randomColor}}
}
