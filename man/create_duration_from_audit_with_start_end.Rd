% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/duration_claculation.R
\name{create_duration_from_audit_with_start_end}
\alias{create_duration_from_audit_with_start_end}
\title{Calculate duration between two questions from an audit log}
\usage{
create_duration_from_audit_with_start_end(
  audit_file,
  start_question,
  end_question
)
}
\arguments{
\item{audit_file}{A data frame containing one audit log with at least the
columns \code{event}, \code{node}, \code{start}, and \code{end}. Timestamps are expected in
milliseconds since the epoch.}

\item{start_question}{Character scalar giving the trailing node label of the
starting question (matched at the end of \code{node}, e.g., \code{"question1"} matches
\code{"/form/group/question1"}).}

\item{end_question}{Character scalar giving the trailing node label of the
ending question (matched at the end of \code{node}).}
}
\value{
A data frame with two columns:
\describe{
\item{duration_ms}{Elapsed time in milliseconds.}
\item{duration_minutes}{Elapsed time in minutes, rounded to one decimal.}
}
}
\description{
Computes the time elapsed between the \strong{start} timestamp of a
\code{start_question} and the \strong{end} timestamp of an \code{end_question} in a
single audit file. If a question node appears multiple times (e.g., edits
or select-multiple behavior), the function uses the \strong{minimum} \code{start}
for the starting question and the \strong{maximum} \code{end} for the ending question.
}
\details{
If either question is missing (e.g., due to skip logic or not present in
the audit), the calculation yields \code{-Inf} for the duration (via
\code{max(numeric(0)) - min(numeric(0))} semantics).

Nodes are matched with a regex that anchors to the end of the \code{node} path,
so only exact trailing matches are used. When a question occurs multiple
times, the earliest \code{start} and latest \code{end} are taken to span the full interaction.
}
\examples{
\dontrun{
some_audit <- data.frame(
  event = c("form start", rep("question", 5)),
  node  = c("", paste0("/xx/question", 1:5)),
  start = c(1661415887295, 1661415887301, 1661415890819,
            1661415892297, 1661415893529, 1661415894720),
  end   = c(NA, 1661415890790, 1661415892273,
            1661415893506, 1661415894703, 1661415896452)
)
create_duration_from_audit_with_start_end(
  some_audit, "question1", "question3"
)
}

}
